
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Carousel AD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
  <script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script>
  
  <script>
    var googletag = googletag || {};
    googletag.cmd = googletag.cmd || [];
  </script>

  <script>
    var getCookie = name => {
      //获取name在Cookie中起止位置
      let start = document.cookie.indexOf(name + "=")

      if (start !== -1) {
        start = start + name.length + 1
        //获取value的终止位置
        let end = document.cookie.indexOf(";", start)
        if (end === -1)
          end = document.cookie.length
        //截获cookie的value值,并返回
        return unescape(document.cookie.substring(start, end))
      }
      return ""
    }

    // get ad param from android
    var isAndroid = typeof window.Android !== 'undefined'
    var adParamsDict = []

    if (isAndroid && window.Android.getAdKeyValue && window.Android.getAdKeyValue()) {
      adKeyValue = JSON.parse(window.Android.getAdKeyValue())
      if (window.Android.getCampaignId) {
        adKeyValue.campaign_id = window.Android.getCampaignId() ? window.Android.getCampaignId() : '0'
      }
    } else {
      // this default params var browser can see ad
      adKeyValue = {
        hotel_id: 5707,
        campaign_id: 0,
        lang:'en_GB',
        star:0,
        country:100,
        zone_id:3
      }
    }

    var adKeyArr = Object.keys(adKeyValue)
    adKeyArr.forEach((key, index) => {
      adParamsDict[index] = {}
      adParamsDict[index].key = adKeyArr[index]
      adParamsDict[index].value = adKeyValue[adKeyArr[index]]
    })


    console.log(adParamsDict,66666)
    
    var AD_HOST = window.location.host
    let adPath

    if (AD_HOST === 'b2c-ads.hi.com') {
      adPath = 'Tinklabs'
    } else if (AD_HOST === 'ads-uat.handytravel.tech') {
      adPath = 'UAT'
    } else {
      adPath = 'Test'
    }

    // googletag.impl.pubads.callbackProxy1()
    googletag.cmd.push(function () {
      googletag.defineSlot(`/21623654641/${adPath}/Temp-C`, [360, 363], 'div-gpt-ad-1547119989301-0').addService(
        googletag.pubads())

      googletag.pubads().enableSingleRequest();
      googletag.enableServices();

      googletag.pubads().collapseEmptyDivs();

      // dynamic set google ad params
      adParamsDict.forEach(item => {
        googletag.pubads().setTargeting(item.key, [item.value])
      })

      googletag.pubads().addEventListener('slotOnload', () => {
        document.querySelector('#div-gpt-ad-1547119989301-0').style.height='363px'
        document.querySelector('#div-gpt-ad-1547119989301-0').style.overflowY = 'visible'
      })

    });
  </script>
  <!-- Demo styles -->
<style>
body{
  margin:0 !important;
}
.buy-notice{
  width:209px;
  height:22px;
}
</style>
</head>
<body>
    <div id='div-gpt-ad-1547119989301-0' style="min-width:360px;height:0px;overflow-y: hidden;">
        <script>
        googletag.cmd.push(function () {
            googletag.display('div-gpt-ad-1547119989301-0');
        });
        </script>
    </div>
</body>
</html>
